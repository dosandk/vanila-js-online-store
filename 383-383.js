"use strict";(self.webpackChunkvanila_js_online_store=self.webpackChunkvanila_js_online_store||[]).push([[383],{948:(e,t,n)=>{n.d(t,{H:()=>r,Oo:()=>a,SO:()=>l,az:()=>i,xg:()=>o});const s=globalThis.document,i=(e="")=>{const t=s.createElement("div");return t.innerHTML=e,t.firstElementChild||t},r=(e,t="[data-element]")=>{const n={},s=e.querySelectorAll(t);for(const e of s){n[e.dataset.element]=e}return n},a=(e,t="",n,s={})=>(e.addEventListener(t,n,s),()=>{e.removeEventListener(t,n,s)}),o=(e,t="",n,s={})=>{e.removeEventListener(t,n,s)},l={window:globalThis.window,document:globalThis.window.document,body:globalThis.window.document.body}},931:(e,t,n)=>{function s(e,t,n,s){return a(e,t),r(n,"set"),function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,n,s),s}function i(e,t,n){return a(e,t),r(n,"get"),function(e,t){if(t.get)return t.get.call(e);return t.value}(e,n)}function r(e,t){if(void 0===e)throw new TypeError("attempted to "+t+" private static field before its declaration")}function a(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}n.d(t,{Z:()=>c});class o{constructor(){var e,t,n;n={},(t="callbacks")in(e=this)?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}static get instance(){return i(o,o,l)||s(o,o,l,new o),i(o,o,l)}dispatchEvent(e){const{type:t,payload:n}=e,s=this.callbacks[t];if(s)for(const[e]of s.entries())e(n)}subscribe(e,t){return this.callbacks[e]?this.callbacks[e].set(t,null):this.callbacks[e]=new Map([[t,null]]),()=>this.callbacks[e].delete(t)}}var l={writable:!0,value:void 0};const c=e=>{var t,n,s,i;return n=t=class extends e{constructor(...e){e.push(o.instance),super(...e)}},s="name",i=`connected to observer ${e.name}`,s in n?Object.defineProperty(n,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[s]=i,t}},383:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var s=n(948),i=n(69);class r{constructor(){var e,t,n;n={},(t="items")in(e=this)?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,this.render(),this.getSubElements(),this.initEventListeners()}get template(){return'\n      <div class="cart-container">\n        <ul class="cart-list" data-element=\'list\'>\n          \x3c!-- List component --\x3e\n        </ul>\n        <div class="footer">\n          <div class="cart-total">\n            Total: <span data-element="total">0</span>\n          </div>\n          <button class="order-btn os-btn-primary" data-element="orderBtn">Order</button>\n        </div>\n      </div>\n    '}render(){const e=document.createElement("div");e.innerHTML=this.template,this.element=e.firstElementChild}getSubElements(){const e={},t=this.element.querySelectorAll("[data-element]");for(const n of t){e[n.dataset.element]=n}this.subElements=e}initEventListeners(){this.element.addEventListener("pointerdown",(e=>{const t=e.target.closest("[data-counter]");if(t){const n=e.target.closest('[data-element="counterContainer"]'),{id:s}=n.dataset,{counter:i}=t.dataset,r=n.querySelector(`[data-element="${s}"]`),a=r.innerText,o=parseInt(a,10)+parseInt(i,10);parseInt(i,10)>0?this.element.dispatchEvent(new CustomEvent("add-to-cart",{detail:this.items[s],bubbles:!0})):this.element.dispatchEvent(new CustomEvent("remove-from-cart",{bubbles:!0})),0===o?(delete this.items[s],n.remove()):(this.items[s].count=o,r.innerText=o,this.updatePrice(this.items[s])),this.updateTotal()}}))}updatePrice(e){const t=this.element.querySelector(`[data-id="${e.id}"]`);if(t){const n=t.querySelector('[data-element="price"]'),s=t.querySelector(`[data-element="${e.id}"]`);n.innerText=e.price*e.count,s.innerText=e.count}}add(e={}){const t=this.items[e.id];if(t)t.count+=1,this.updatePrice(t);else{const t={...e,count:1};this.items[e.id]=t;const n=this.renderItem(t);this.subElements.list.append(n)}this.updateTotal()}updateTotal(){const e=Object.keys(this.items).reduce(((e,t)=>e+this.items[t].count*this.items[t].price),0);this.subElements.total.innerHTML=e}renderItem(e={}){const t=document.createElement("div"),{id:n,images:s,title:i,count:r,price:a}=e,o=`\n      <li class="item-row" data-element="counterContainer" data-id="${n}">\n        <div class="item-preview">\n          <img src="${s[0].url}" alt="${i}">\n        </div>\n        <div class="item-name">\n          ${i}\n        </div>\n        <div class="item-counter">\n          <button class="count-btn" data-counter="-1">\n            <i class="bi bi-dash-circle"></i>\n          </button>\n          <span data-element="${n}">${r}</span>\n          <button class="count-btn" data-counter="1">\n            <i class="bi bi-plus-circle"></i>\n          </button>\n        </div>\n        <div class="item-price" data-element="price">\n          ${a*r}\n        </div>\n      </li>\n    `;return t.innerHTML=o,t.firstElementChild}}var a=n(931);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const l=(0,i.Z)((0,a.Z)(class{constructor(e,t,n){o(this,"subElements",{}),o(this,"components",{}),o(this,"subscriptions",[]),this.store=t,this.observer=n;const{products:s}=this.store.getState();this.products=s,this.initialize()}initialize(){this.initComponents(),this.render(),this.renderComponents()}getTemplate(){return'\n      <div class="page-container">\n        <h1 class="page-title">Cart</h1>\n        <div data-element="cart">\n          \x3c!-- Cart component --\x3e\n        </div>\n      </div>\n    '}initComponents(){const e=new r;for(const t of this.products)e.add(t);this.components={cart:e}}renderComponents(){for(const e of Object.keys(this.components)){const t=this.subElements[e],{element:n}=this.components[e];t.append(n)}}render(){const e=document.createElement("div");e.innerHTML=this.getTemplate(),this.element=e.firstElementChild,this.subElements=(0,s.H)(this.element)}remove(){this.element&&this.element.remove()}destroy(){this.remove();for(const e of Object.values(this.components))e.destroy&&e.destroy();for(const e of this.subscriptions)e();this.element=null,this.components=null,this.subElements=null}}))}}]);